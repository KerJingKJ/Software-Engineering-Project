{% extends base_template %}
{% load static %}

{% block content %}
<link href="{% static 'login/css/change_password.css' %}" type="text/css" rel="stylesheet" />

<div id="manageAccount-container">
<h1 style="margin-top: -50px; margin-left: 20px;">Manage Account</h1>

<div class="content-account">
    <div class="sidebar">
    {% if '/reviewer/' in request.path %}
        <a href="{% url 'reviewer_change_password' %}" 
           class="{% if request.resolver_match.url_name == 'reviewer_change_password' %}active{% endif %}">
           Change Password
        </a>
        <a href="{% url 'reviewer_update_security_questions' %}"
           class="{% if request.resolver_match.url_name == 'reviewer_update_security_questions' %}active{% endif %}">
           Update Security Question
        </a>
    
    {% elif '/committee/' in request.path %}
        <a href="{% url 'committee_change_password' %}" 
           class="{% if request.resolver_match.url_name == 'committee_change_password' %}active{% endif %}">
           Change Password
        </a>
        <a href="{% url 'committee_update_security_questions' %}"
           class="{% if request.resolver_match.url_name == 'committee_update_security_questions' %}active{% endif %}">
           Update Security Question
        </a>

    {% else %}
    <a href="{% url 'student_change_password' %}" 
           class="{% if request.resolver_match.url_name == 'student_change_password' %}active{% endif %}">
           Change Password
        </a>
        <a href="{% url 'student_update_security_questions' %}"
           class="{% if request.resolver_match.url_name == 'student_update_security_questions' %}active{% endif %}">
           Update Security Question
        </a>


    {% endif %}

    {% if is_student %}
    <a href="{% url 'student_update_profile' %}"
     class="{% if request.resolver_match.url_name == 'student_update_profile' %}active{% endif %}"
    >Update Profile</a>
    {% endif %}
        
    </div>

    <div class="settings-container">
        <h2>Update Your Profile</h2>
            <div id="change-form">
                <form method="post">
                    {% csrf_token %}
                    
                    <h3>Personal Information</h3>
                    {{ form.as_p }}

                    {% if is_student and student_form %}
                        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #ccc;">
                        <h3>Academic Information</h3>
                        
                        {% for field in student_form %}
                        <div style="margin-bottom: 15px;"> <label for="{{ field.id_for_label }}" style="display:block; font-weight:600; margin-bottom:5px;">
                                {{ field.label }}
                            </label>
                            
                            {{ field }}
                            
                            {% if field.help_text %}
                                <small style="display: block; color: #666; font-size: 0.85rem; margin-top: -10px;
                                    {% if field.name == 'student_type' or field.name == 'education_level' %}
                                        margin-top: 10px;
                                    {% else %}
                                        margin-top: -15px; 
                                    {% endif %}">
                                    {{ field.help_text }}
                                </small>
                            {% endif %}

                            {% if field.errors %}
                                <div style="color: red; font-size: 0.85rem; margin-top: 2px;">
                                    {{ field.errors|striptags }}
                                </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    {% endif %}

                    <div id="button-group" style="margin-top: 20px;">
                        <button type="submit" class="button">Save Changes</button>
                        <button type="submit" name="cancel" class="button-2">Cancel</button>
                    </div>
                </form>
            </div>
    </div>
</div>

</div>

{% endblock %}
