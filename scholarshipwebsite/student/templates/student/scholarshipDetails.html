{% extends 'student/base.html' %}
{% load static %}

{% block content %}
<div class="detail-container">
    
    <h1 class="main-title">Scholarships Offer</h1>

    <div class="scholarship-content">
        <div class="header-container" style="display: flex; align-items: center; gap: 15px;">
            <h1 class="scholarship-title">{{ scholarship.name }}</h1>

            <a href="{% url 'toggle_bookmark' scholarship.id %}" class="bookmark-btn" style="text-decoration: none;">
                {% if is_bookmarked %}
                    <img src="{% static 'student/img/bookmark-filled.png' %}" alt="Saved" width="30" height="30">
                {% else %}
                    <img src="{% static 'student/img/bookmarkicon.png' %}" alt="Save" width="30" height="30">
                {% endif %}
            </a>
        </div>
        <p class="description">{{ scholarship.description }}</p>
        <p>Deadline: {{ scholarship.deadline }}</p>
        <h3 class="section-title"><u>Criteria & Entitlement</u></h3>

        <table class="criteria-table" style="border: 2px solid #034EA1; ">
            <thead>
                <tr>
                    <th style="border-right: 1px solid #034EA1; border-bottom: 1px solid #034EA1;">Qualification</th>
                    <th style="border-right: 1px solid #034EA1; border-bottom: 1px solid #034EA1;">Requirement</th>
                    <th style="border-bottom: 1px solid #034EA1;">Entitlement</th>
                </tr>
            </thead>
            <tbody>
                {% for criteria in scholarship.criteria_list.all %}
                <tr style="border: 1px solid #034EA1;">
                    <td class="col-left" style="border: 1px solid #034EA1;">{{ criteria.qualification }}</td>
                    <td class="col-center" style="border: 1px solid #034EA1;">
                        {{ criteria.get_criteria_type_display }}: 
                        {% if criteria.criteria_type == 'A_COUNT' %}
                            {{ criteria.min_value|floatformat:0 }}
                        {% else %}
                            {{ criteria.min_value }}
                        {% endif %}
                    </td>
                    <td class="col-right" style="border: 1px solid #034EA1;">{{ criteria.entitlement }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" style="text-align:center;">
                        Check requirements in description.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div>Programme: {{ scholarship.education_level }}</div>
        <div>Nationality: {{ scholarship.student_type }}</div>
        
        <div class="notes-section">
            <strong>Notes:</strong>
            <ol style="margin-top: 5px; padding-left: 20px;">
                {% for note in scholarship.get_notes_list %}
                    <li>{{ note }}</li>
                {% empty %}
                    <li>No notes provided.</li>
                {% endfor %}
            </ol>
        </div>
    </div>
    <div class="action-buttons">
        <a href="{% url 'scholarship_list' %}" class="btn-nav">Back</a>
        <a href="{% url 'application_form' %}" class="btn-nav">Apply Now</a>
    </div>

</div>

<script>
    {% comment %} // 1. Get the URL parameters (e.g., ?id=merit)
    const urlParams = new URLSearchParams(window.location.search);
    const scholarshipId = urlParams.get('id');

    // 2. Define which ID corresponds to which Div
    // Default to 'chancellor' if no ID is found
    const targetId = scholarshipId ? 'content-' + scholarshipId : 'content-chancellor';

    // 3. Show the correct div
    const element = document.getElementById(targetId);
    if (element) {
        element.style.display = 'block';
    } else {
        // Fallback if ID doesn't exist
        document.getElementById('content-chancellor').style.display = 'block';
    } {% endcomment %}

    function toggleBookmark(imgElement) {
        // Check if the current source contains the 'empty' image name
        if (imgElement.src.includes('bookmarkicon.png')) {
            // Change to filled version
            imgElement.src = "{% static 'student/img/bookmark-filled.png' %}";
        } else {
            // Change back to empty version
            imgElement.src = "{% static 'student/img/bookmarkicon.png' %}";
        }
    }
</script>

{% endblock %}